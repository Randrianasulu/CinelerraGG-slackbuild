From 8788741cc392626f3f253451d9e80e85d8267de4 Mon Sep 17 00:00:00 2001
From: Andrew Randrianasulu <randrianasulu@gmail.com>
Date: Tue, 16 Jan 2024 09:56:01 +0300
Subject: [PATCH 3/4] Only add aspect= line to options if wide (16:9)

---
 cinelerra-5.1/cinelerra/bdcreate.C | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/cinelerra-5.1/cinelerra/bdcreate.C b/cinelerra-5.1/cinelerra/bdcreate.C
index a3869657..dac7e442 100644
--- a/cinelerra-5.1/cinelerra/bdcreate.C
+++ b/cinelerra-5.1/cinelerra/bdcreate.C
@@ -432,11 +432,13 @@ int CreateBD_Thread::create_bd_jobs(ArrayList<BatchRenderJob*> *jobs, const char
 	FFMPEG::set_option_path(option_path, "video/%s", asset->vcodec);
 	FFMPEG::load_options(option_path, asset->ff_video_options,
 		 sizeof(asset->ff_video_options));
+	if(session->aspect_w == 16) {
 	char aspect_line[100];
 	float par = (float)((float)asset->width / (float)asset->height);
 	sprintf(aspect_line, "aspect=%f\n", asset->aspect_ratio/par);
 	strcat(asset->ff_video_options, aspect_line);
 	//printf("Aspect line: %s par: %f width: %i height: %i\n ", aspect_line, par, asset->width, asset->height);
+	}
 	asset->ff_video_bitrate = vid_bitrate;
 	asset->ff_video_quality = -1;
 	return 0;
-- 
2.35.8

