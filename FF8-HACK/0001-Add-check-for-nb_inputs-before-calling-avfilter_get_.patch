From 549a316febc8b36bb3ed222961f0bb1da40f27ae Mon Sep 17 00:00:00 2001
From: Andrew Randrianasulu <randrianasulu@gmail.com>
Date: Sat, 10 May 2025 11:06:44 +0300
Subject: [PATCH 1/5] Add check for nb_inputs before calling
 avfilter_get_pad_name, fixes crash

---
 cinelerra-5.1/cinelerra/ffmpeg.C | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/cinelerra-5.1/cinelerra/ffmpeg.C b/cinelerra-5.1/cinelerra/ffmpeg.C
index 1d0979df..82ae0856 100644
--- a/cinelerra-5.1/cinelerra/ffmpeg.C
+++ b/cinelerra-5.1/cinelerra/ffmpeg.C
@@ -3903,7 +3903,9 @@ int FFVideoStream::create_filter(const char *filter_spec)
 		while( --i>=0 && *sp!=0 && !strchr(" \t:=,",*sp) ) *np++ = *sp++;
 		*np = 0;
 		const AVFilter *filter = !filter_name[0] ? 0 : avfilter_get_by_name(filter_name);
-		if( !filter || avfilter_pad_get_type(filter->inputs,0) != AVMEDIA_TYPE_VIDEO ) {
+		//AVFilterContext *ctx = filter->ctx;
+		int       nb_pads = filter->nb_inputs;
+		if( !filter || (nb_pads>1 && avfilter_pad_get_type(filter->inputs,0)) != AVMEDIA_TYPE_VIDEO ) {
 			ff_err(AVERROR(EINVAL), "FFVideoStream::create_filter: %s\n", filter_spec);
 			return -1;
 		}
-- 
2.46.3

