From d3dd30c3d78cdd945c0f6ba78fd2eb264ada69c7 Mon Sep 17 00:00:00 2001
From: Andrew Randrianasulu <randrianasulu@gmail.com>
Date: Sat, 30 Dec 2023 20:26:24 +0300
Subject: [PATCH 1/3] Set also sample aspect ratio for encoded ffmpeg stream

---
 cinelerra-5.1/cinelerra/ffmpeg.C | 1 +
 1 file changed, 1 insertion(+)

diff --git a/cinelerra-5.1/cinelerra/ffmpeg.C b/cinelerra-5.1/cinelerra/ffmpeg.C
index e95cc87e..870cdd3c 100644
--- a/cinelerra-5.1/cinelerra/ffmpeg.C
+++ b/cinelerra-5.1/cinelerra/ffmpeg.C
@@ -3037,6 +3037,7 @@ int FFMPEG::open_encoder(const char *type, const char *spec)
 				frame_rate.num, frame_rate.den, INT_MAX);
 			ctx->framerate = (AVRational) { frame_rate.num, frame_rate.den };
 			ctx->time_base = (AVRational) { frame_rate.den, frame_rate.num };
+			st->sample_aspect_ratio = to_sample_aspect_ratio(asset);
 			st->avg_frame_rate = frame_rate;
 			st->time_base = ctx->time_base;
 			vid->writing = -1;
-- 
2.35.8

